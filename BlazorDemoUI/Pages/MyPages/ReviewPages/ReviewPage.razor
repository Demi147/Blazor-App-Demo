@page "/review"

@using System.IO;
@using BlazorDemoUI.Services;
@using DataAccessLibrary
@using DataAccessLibrary.Models
@using BlazorDemoUI.Models

@inject ISiteReviewData _db
@inject NavigationManager navigationManager

<h3>Review The Website:</h3>
<br />
<div class="row">
    <div class="col-md-6">
        <h3>Rating with 5 stars</h3>
        <Radzen.Blazor.RadzenRating Style="margin-bottom: 20px" Change="@((args) => Change(args, "Rating with 5 stars"))" />
        <br />
    </div>
</div>

<h3>Comment below:</h3>

<EditForm Model="@reviewModel">
    <InputTextArea id="txtComment" class="form-control col-3" @bind-Value="@comment" />
</EditForm>

<button class="btn btn-primary" @onclick="@InsertReview">Create</button>


@code {

    SiteReview reviewModel = new SiteReview();
    string comment { get; set; } = "";

    public int iRating;

    Dictionary<DateTime, string> events = new Dictionary<DateTime, string>();

    void Change(int value, string name)
    {
        iRating = value;
    }

    public async Task InsertReview()
    {
        try
        {
            SiteReview review = new SiteReview
            {
                UserID = 3,
                Rating = iRating,
                ReviewText = comment,
                ReviewDate = DateTime.Now.Date
            };

            await _db.InsertReview(review);

            navigationManager.NavigateTo("BooksPages/Main");
        }
        catch (Exception ex)
        {
            string stest = ex.ToString();
        }
    }
}
